{"version":3,"file":"index.js","sources":["src/factory.js","src/read.js","src/write.js","src/read-deep.js","src/write-deep.js"],"sourcesContent":["\nfunction createProxy(stack, ...trapChain) {\n\tif(!Array.isArray(stack)) {\n\t\tstack = Array.from(arguments);\n\t\ttrapChain = [];\n\t}\n\n\tlet target = stack[0];\n\tlet handler = { stack };\n\n\ttrapChain.push(...this.traps);\n\n\ttrapChain.forEach(function(levelTraps) {\n\t\tObject.getOwnPropertyNames(levelTraps).forEach(function(property) {\n\t\t\tif(!handler.hasOwnProperty(property)) {\n\t\t\t\tObject.defineProperty(handler, property, Object.getOwnPropertyDescriptor(levelTraps, property));\n\t\t\t}\n\t\t});\n\t});\n\n\treturn new Proxy(target, handler)\n}\n\nfunction proxyFactory(...trapChain) {\n\tlet traps = [];\n\n\ttrapChain.forEach(function(factory) {\n\t\tif(factory.traps) {\n\t\t\ttraps.push(...factory.traps);\n\t\t} else {\n\t\t\ttraps.push(factory);\n\t\t}\n\t});\n\n\tlet factory = createProxy.bind({\n\t\ttraps : traps\n\t});\n\n\tfactory.traps = traps;\n\n\treturn factory;\n}\n\nexport default proxyFactory;\n","import proxyFactory from './factory.js';\n\nconst traps = Object.freeze({\n\tset(target, property, value) {\n\t\treturn Reflect.set(this.stack[0], property, value);\n\t},\n\tget(target, property) {\n\t\tvar host = this.findHost(property);\n\n\t\tif(host) {\n\t\t\treturn host[property];\n\t\t}\n\t},\n\tgetOwnPropertyDescriptor(target, property, receiver) {\n\t\tvar host = this.findHost(property);\n\n\t\tif(host) {\n\t\t\tvar desc = Object.getOwnPropertyDescriptor(host, property);\n\n\t\t\tif(desc) {\n\t\t\t\treturn desc;\n\t\t\t}\n\n\t\t\tif(host = Object.getPrototypeOf(host)) {\n\t\t\t\treturn Object.getOwnPropertyDescriptor(host, property);\n\t\t\t}\n\t\t}\n\t},\n\townKeys(target) {\n\t\tlet set = new Set();\n\n\t\tthis.stack.forEach(function(level) {\n\t\t\t\tReflect.ownKeys(level).forEach(set.add, set);\n\t\t});\n\n\t\treturn Array.from(set);\n\t},\n\thas(target, property) {\n\t\treturn this.findHost(property);\n\t},\n\n\t/**\n\treturns the first object in stack that has the property\n\tif none matches and root is set the top of the stack will be returned\n\t*/\n\tfindHost(property, root) {\n\t\tlet host = this.stack.find(function(level) {\n\t\t\treturn property in level;\n\t\t});\n\n\t\tif(host) {\n\t\t\treturn host;\n\t\t}\n\n\t\tif(root === true) {\n\t\t\treturn this.stack[0];\n\t\t}\n\t}\n});\n\nconst factory = proxyFactory(traps);\n\nexport {\n\tfactory as default,\n\ttraps\n}\n","import proxyFactory from './factory.js';\nimport proxyRead from './read.js';\n\nconst traps = Object.freeze({\n\tset(target, property, value) {\n\t\treturn Reflect.set(this.findHost(property, true), property, value);\n\t},\n\tdefineProperty(target, property, descriptor) {\n\t\treturn Reflect.defineProperty(this.findHost(property, true), property, descriptor);\n\t},\n\tdeleteProperty(target, property) {\n\t\treturn Reflect.deleteProperty(this.findHost(property, true), property);\n\t}\n});\n\nconst factory = proxyFactory(traps, proxyRead);\n\nexport {\n\tfactory as default,\n\ttraps\n};\n","import proxyFactory from './factory.js';\nimport proxyRead from './read.js';\n\nconst objectToString = Object.prototype.toString;\n\nconst traps = {\n\tget(target, property) {\n\t\tvar hosts = this.findAllHosts(property);\n\n\t\tswitch(hosts.length) {\n\t\t\tcase 0:\n\t\t\t\treturn undefined;\n\t\t\tcase 1:\n\t\t\t\treturn hosts[0][property];\n\t\t}\n\n\t\tlet stack = [];\n\n\t\tfor(let i = 0; i < hosts.length ; i++) {\n\t\t\tlet host = hosts[i];\n\t\t\tlet value = host[property];\n\n\t\t\tswitch(objectToString.call(value)) {\n\t\t\t\tcase \"[object Object]\":\n\t\t\t\tcase \"[object Array]\":\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tstack.push(value);\n\t\t}\n\n\t\treturn this.factory(stack);\n\t},\n\t/**\n\t\treturns all objects in stack that have the property\n\t\tif none matches and root is set the top of the stack will be pushed\n\t*/\n\tfindAllHosts(property, root) {\n\t\tlet hosts = this.stack.filter(function(level) {\n\t\t\treturn property in level;\n\t\t});\n\n\t\tif(hosts.length == 0 && root === true) {\n\t\t\thosts.push(this.stack[0]);\n\t\t}\n\n\t\treturn hosts;\n\t}\n};\n\nconst factory = traps.factory = proxyFactory(traps, proxyRead);\n\nexport {\n\tfactory as default,\n\ttraps\n}\n","import proxyFactory from './factory.js';\nimport proxyReadDeep from './read-deep.js';\nimport { traps as writeTraps } from './write.js';\n\nconst traps = {};\n\nconst factory = traps.factory = proxyFactory(traps, writeTraps, proxyReadDeep);\n\nexport {\n\tfactory as default,\n\ttraps\n}\n"],"names":["traps","factory","proxyRead","writeTraps","proxyReadDeep"],"mappings":"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"}